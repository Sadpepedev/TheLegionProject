<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
  <title>Track Legion ICO Performance</title>
  
  <!-- Security Headers -->
  
  <!-- Content-Security-Policy -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com https://fonts.googleapis.com https://fonts.gstatic.com https://*.vercel-insights.com;
    style-src 'self' 'unsafe-inline' https://fonts.googleapis.com;
    font-src 'self' https://fonts.gstatic.com;
    object-src 'none';
    base-uri 'self';
    frame-ancestors 'none';
  ">
  
  <!-- Prevent Content Type Sniffing -->
  <meta http-equiv="X-Content-Type-Options" content="nosniff">
  
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  
  <!-- Google Font -->
  <link 
    href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" 
    rel="stylesheet"
  >
  
  <style>
    body {
      background: radial-gradient(ellipse at bottom, #1b2735 0%, #090a0f 100%);
      color: #FFFFFF;
      font-family: 'Orbitron', sans-serif; /* Futuristic vibe */
      margin: 0; /* Remove default margin */
    }

    /* Active tab highlight */
    .active-tab {
      border-bottom: 2px solid #18FFF7; 
      font-weight: bold;
      transition: all 0.2s ease-in-out;
    }

    /* Status badges */
    .badge-live {
      background-color: #4CAF50; /* Green */
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      display: inline-block;
      margin-top: 0.5rem;
    }
    .badge-soon {
      background-color: #60A5FA; /* Blue */
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      display: inline-block;
      margin-top: 0.5rem;
    }
    .badge-ico {
      background-color: #FB923C; /* Orange */
      color: white;
      padding: 0.25rem 0.5rem;
      border-radius: 0.25rem;
      font-size: 0.75rem;
      display: inline-block;
      margin-top: 0.5rem;
    }

    /* Disabled */
    .disabled-button {
      background-color: #4A5568; /* Gray */
      cursor: not-allowed;
      opacity: 0.5;
    }

    /* Hide results by default */
    #results {
      display: none;
    }

    /* Navigation tabs hover effect */
    .sale-tab {
      transition: color 0.2s ease-in-out;
    }
    .sale-tab:hover {
      color: #18FFF7;
    }

    /* Connect Wallet button (currently hidden) */
    .hidden-button {
      display: none;
    }

    /* "Support the Site" button with unique but subtle styling */
    .support-button {
      border: 1px solid #18FFF7;
      transition: all 0.3s ease;
    }
    .support-button:hover {
      color: #18FFF7;
      box-shadow: 0 0 5px #18FFF7;
    }

    /* Numeric input without spinners */
    input[type=number]::-webkit-outer-spin-button,
    input[type=number]::-webkit-inner-spin-button {
      -webkit-appearance: none;
      margin: 0;
    }
    /* Firefox */
    input[type=number] {
      -moz-appearance: textfield;
    }

    /* Smooth dropdown transition */
    .transition-height {
      transition: max-height 0.3s ease-in-out;
    }

    /* Table styles for Overview */
    .overview-table {
      width: 100%;
      border-collapse: collapse;
    }

    .overview-table th, .overview-table td {
      padding: 0.75rem;
      text-align: left;
      border-bottom: 1px solid #2D3748;
    }

    .overview-table th {
      background-color: #2D3748;
      color: #18FFF7;
    }

    .overview-table tr:hover {
      background-color: #2A4365;
    }

    .overview-table td {
      color: #CBD5E0;
    }

    .overview-table .roi-positive {
      color: #4CAF50;
    }

    .overview-table .roi-negative {
      color: #F56565;
    }
  </style>

  <!-- Vercel Scripts (Optional, can remove if not using Vercel) -->
  <script>
    window.si = window.si || function () {
      (window.siq = window.siq || []).push(arguments);
    };
  </script>
  <script defer src="/_vercel/speed-insights/script.js"></script>
  <script>
    window.va = window.va || function () {
      (window.vaq = window.vaq || []).push(arguments);
    };
  </script>
  <script defer src="/_vercel/insights/script.js"></script>

</head>
<body>
  <!-- Flex Container -->
  <div class="flex flex-col min-h-screen">
    <!-- Top Nav Bar -->
    <nav class="shadow-md" style="background-color: rgba(0,0,0,0.75);">
      <div class="container mx-auto flex flex-col lg:flex-row items-center justify-center py-4 px-6">
        <!-- Left: Tabs / Hamburger -->
        <div class="flex flex-col lg:flex-row items-center w-full lg:w-auto">
          <!-- Hamburger Menu (Mobile) -->
          <div class="block lg:hidden mb-4 lg:mb-0">
            <button id="mobileMenuToggle" class="text-white focus:outline-none">
              <svg 
                xmlns="http://www.w3.org/2000/svg" 
                class="h-6 w-6" 
                fill="none" 
                viewBox="0 0 24 24" 
                stroke="currentColor"
              >
                <path 
                  stroke-linecap="round" 
                  stroke-linejoin="round" 
                  stroke-width="2" 
                  d="M4 6h16M4 12h16M4 18h16" 
                />
              </svg>
            </button>
          </div>

          <!-- Navigation Tabs -->
          <div id="navTabs" class="hidden lg:flex lg:space-x-6 lg:flex-row lg:items-center flex-col w-full lg:w-auto transition-all duration-300 ease-in-out">
            <button class="sale-tab active-tab" onclick="switchSale('overview')">Overview</button>
          </div>
        </div>

        <!-- Right: (Hidden) Connect Wallet + Support the Site -->
        <div class="mt-4 lg:mt-0 flex flex-row space-x-2 w-full lg:w-auto lg:ml-6">
          <!-- Connect Wallet Hidden -->
          <button
            class="neon-button py-2 px-4 text-white rounded hidden-button"
            onclick="alert('Coming Soon!')"
          >
            Connect Wallet
          </button>

          <!-- Support the Site (Unique but less flashy) -->
          <button
            class="support-button py-2 px-4 text-white rounded w-full lg:w-auto"
            onclick="supportSite()"
          >
            Support the Site
          </button>
        </div>
      </div>
    </nav>

    <!-- MAIN CONTENT -->
    <main class="flex-grow">
      <!-- OVERVIEW SECTION -->
      <div
        id="overviewSection"
        class="container mx-auto mt-12 px-6 py-8 rounded-lg shadow-lg max-w-4xl"
        style="display: none; background-color: rgba(0,0,0,0.65);"
      >
        <h2 class="text-3xl font-extrabold text-center mb-6" style="color: #18FFF7;">
          Token Overviews
        </h2>
        <p class="text-sm text-center text-gray-400 mb-8">
          Below are all Legion ICOs and their current ROI (in %):
        </p>

        <!-- Overview Table -->
        <div class="overflow-x-auto">
          <table class="overview-table">
            <thead>
              <tr>
                <th>Token</th>
                <th>Trading Date</th>
                <th>ICO Price ($)</th>
                <th>Current Price ($)</th>
                <th>ROI (%)</th>
                <th>If you invested $1000</th>
              </tr>
            </thead>
            <tbody id="overviewList" class="space-y-4"></tbody>
          </table>
        </div>
      </div>
    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-900 text-gray-300 py-8">
      <div class="container mx-auto px-6 flex flex-col md:flex-row justify-between items-center">
        
        <!-- Built By Section -->
        <div class="flex items-center mb-6 md:mb-0">
          <!-- Optional: Add an Icon or Logo -->
          <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-pink-500 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
          </svg>
          
          <div>
            <p class="text-xl font-semibold text-white">Built by</p>
            <a href="https://x.com/Dustybeerbong" target="_blank" class="text-pink-400 hover:text-pink-300 transition-colors duration-200">
              Sadpepe.exe
            </a>
          </div>
        </div>
        
        <!-- Additional Footer Content -->
        <div class="text-center md:text-right">
          <p class="text-sm">
            Price data provided by 
            <a href="https://coingecko.com" target="_blank" class="text-blue-400 hover:underline">
              CoinGecko
            </a>.
          </p>
          <p class="mt-2 text-sm">
            <strong>Disclaimer:</strong> We are <em>not</em> affiliated with Legion and do 
            <em>not</em> offer financial or trading advice. This website is purely for informational 
            purposes to assist in tracking prior ICO performance. Always conduct your own 
            research before making any investment decisions.
          </p>
        </div>
      </div>
    </footer>
  </div>

  <!-- Modal for Wallet Address (Optional) -->
  <div id="walletModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden">
    <!-- Modal Content -->
    <div class="bg-gray-800 rounded-lg p-6 max-w-sm w-full">
      <h2 class="text-xl font-semibold text-white mb-4"></h2>
      <p class="text-gray-300 mb-4">If you're feeling generous, I'd love a nice cold drink:</p>
      <div class="flex flex-wrap items-center bg-gray-700 p-2 rounded">
        <span id="walletAddress" class="text-gray-200 mr-2 break-all">0x62f1F6bFE3A798d5023608ac0a9c8a9538276283</span>
        <button onclick="copyWalletAddress()" class="bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600 transition-colors">
          Copy
        </button>
      </div>
      <button onclick="closeModal()" class="mt-4 bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 transition-colors">
        Close
      </button>
    </div>
  </div>

  <!-- Main Script -->
  <script>
    // Mobile menu toggle
    const mobileMenuToggle = document.getElementById("mobileMenuToggle");
    const navTabs = document.getElementById("navTabs");
    mobileMenuToggle.addEventListener("click", () => {
      navTabs.classList.toggle("hidden");
    });

    // All tokens
    const sales = {
      fuel: {
        title: "Fuel",
        tokenName: "Fuel Token",
        seedPrice: 0.02,
        tradingDate: "2023-05-01",
        isTradable: true,
        fontColor: "#32CD32",
        buttonColor: "#32CD32",
        status: "Live",
        statusClass: "badge-live"
      },
      almanak: {
        title: "Almanak",
        tokenName: "Almanak Token",
        seedPrice: 0.05,
        tradingDate: "2023-06-15",
        isTradable: true,
        fontColor: "#FFFFFF",
        buttonColor: "#4A5568",
        status: "Live",
        statusClass: "badge-live"
      },
      pulse: {
        title: "Pulse",
        tokenName: "Pulse Token",
        seedPrice: 0.03,
        tradingDate: "2023-07-20",
        isTradable: true,
        fontColor: "#0000FF",
        buttonColor: "#1E90FF",
        status: "Live",
        statusClass: "badge-live"
      },
      silencio: {
        title: "Silencio",
        tokenName: "Silencio Token",
        seedPrice: 0.04,
        tradingDate: "2023-08-10",
        isTradable: true,
        fontColor: "#87CEEB",
        buttonColor: "#4682B4",
        status: "Live",
        statusClass: "badge-live"
      },
      enclave: {
        title: "Enclave",
        tokenName: "Enclave Token",
        seedPrice: 0.06,
        tradingDate: "N/A",
        isTradable: false,
        fontColor: "#FFFFFF",
        buttonColor: "#ADD8E6",
        status: "Upcoming ICO",
        statusClass: "badge-ico"
      },
      corn: {
        title: "Corn",
        tokenName: "Corn Token",
        seedPrice: 0.01,
        tradingDate: "N/A",
        isTradable: false,
        fontColor: "#FFA500",
        buttonColor: "#FF8C00",
        status: "Upcoming ICO",
        statusClass: "badge-ico"
      }
    };

    // Initialize Overview
    let currentSale = 'overview';

    // Cache for data
    const CACHE_TTL = 120000; // 2 minutes
    let cachedData = {}; // Object to hold cached data per token

    // Show Overview
    function showOverview() {
      const overviewList = document.getElementById("overviewList");
      overviewList.innerHTML = '';

      const tokens = Object.keys(sales);

      tokens.forEach(tokenKey => {
        const tokenData = sales[tokenKey];
        if (!tokenData) return;

        // Fetch current price for tradable tokens
        if (tokenData.isTradable) {
          fetchTokenData(tokenKey, tokenData, () => {
            // Callback can be used if needed after fetching
          });
        } else {
          // For non-tradable tokens, display N/A
          addOverviewItem(tokenData.title, tokenData.tradingDate, tokenData.seedPrice.toFixed(2), "N/A", "N/A", "N/A");
        }
      });
    }

    function fetchTokenData(tokenKey, tokenData, callback) {
      // Use cache if fresh
      if (cachedData[tokenKey] && Date.now() - cachedData[tokenKey].timestamp < CACHE_TTL) {
        displayTokenData(tokenKey, tokenData, cachedData[tokenKey].data);
        if (typeof callback === 'function') callback();
      } else {
        // Fetch current price from API
        // Assuming /calculate endpoint can provide current_price based on seedPrice
        fetch("/calculate", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ investment: 1, round_price: tokenData.seedPrice }),
        })
        .then(res => res.json())
        .then(data => {
          if (!data.error) {
            // Cache the data
            cachedData[tokenKey] = {
              data: data,
              timestamp: Date.now()
            };
            displayTokenData(tokenKey, tokenData, data);
          } else {
            // If error, display N/A
            addOverviewItem(tokenData.title, tokenData.tradingDate, tokenData.seedPrice.toFixed(2), "Error", "Error", "Error");
          }
          if (typeof callback === 'function') callback();
        })
        .catch(() => {
          // On fetch error, display N/A
          addOverviewItem(tokenData.title, tokenData.tradingDate, tokenData.seedPrice.toFixed(2), "Error", "Error", "Error");
          if (typeof callback === 'function') callback();
        });
      }
    }

    function displayTokenData(tokenKey, tokenData, data) {
      // data should contain current_price
      const currentPrice = data.current_price;
      const seedPrice = tokenData.seedPrice;

      // Calculate ROI (%)
      const roi = ((currentPrice - seedPrice) / seedPrice) * 100;

      // Calculate "If you invested $1000 you would have"
      const tokensBought = 1000 / seedPrice;
      const investmentValue = tokensBought * currentPrice;

      // Determine ROI class
      let roiClass = 'roi-positive';
      if (roi < 0) roiClass = 'roi-negative';

      // Format numbers to 2 decimal places
      const formattedCurrentPrice = currentPrice.toFixed(4);
      const formattedROI = roi.toFixed(2) + '%';
      const formattedInvestment = '$' + investmentValue.toFixed(2);

      // Add to overview
      addOverviewItem(tokenData.title, tokenData.tradingDate, seedPrice.toFixed(2), formattedCurrentPrice, formattedROI, formattedInvestment, roiClass);
    }

    // Add an overview row
    function addOverviewItem(tokenName, tradingDate, icoPrice, currentPrice, roi, investment, roiClass) {
      const overviewList = document.getElementById("overviewList");
      const row = document.createElement('tr');

      // Token Name
      const nameEl = document.createElement('td');
      nameEl.textContent = tokenName;
      row.appendChild(nameEl);

      // Trading Date
      const dateEl = document.createElement('td');
      dateEl.textContent = tradingDate;
      row.appendChild(dateEl);

      // ICO Price
      const icoEl = document.createElement('td');
      icoEl.textContent = `$${icoPrice}`;
      row.appendChild(icoEl);

      // Current Price
      const currentEl = document.createElement('td');
      currentEl.textContent = currentPrice === "N/A" || currentPrice === "Error" ? currentPrice : `$${currentPrice}`;
      row.appendChild(currentEl);

      // ROI
      const roiEl = document.createElement('td');
      if (roiClass === 'roi-positive') {
        roiEl.classList.add('roi-positive');
      } else if (roiClass === 'roi-negative') {
        roiEl.classList.add('roi-negative');
      }
      roiEl.textContent = roi;
      row.appendChild(roiEl);

      // If you invested $1000
      const investmentEl = document.createElement('td');
      investmentEl.textContent = investment;
      row.appendChild(investmentEl);

      overviewList.appendChild(row);
    }

    // Switch pages (only overview)
    function switchSale(sale) {
      if (sale === 'overview') {
        // Show overview
        document.getElementById("overviewSection").style.display = "block";
      } else {
        // Not applicable since only overview exists
      }
    }

    // ------------
    // Support Site
    // ------------
    function supportSite() {
      const modal = document.getElementById('walletModal');
      modal.classList.remove('hidden');
    }

    function closeModal() {
      const modal = document.getElementById('walletModal');
      modal.classList.add('hidden');
    }

    function copyWalletAddress() {
      const walletAddress = document.getElementById('walletAddress').textContent;
      navigator.clipboard.writeText(walletAddress).then(() => {
        alert('Wallet address copied to clipboard!');
      }).catch(() => {
        alert('Failed to copy wallet address.');
      });
    }

    // Initialize page
    switchSale(currentSale);
    showOverview();
  </script>
</body>
</html> 
